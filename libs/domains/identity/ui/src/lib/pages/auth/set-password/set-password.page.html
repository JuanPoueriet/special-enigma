<virteex-auth-layout>
  <div class="w-full animate-fade-in-up">
    <!-- Header -->
    <div class="text-center mb-8">
      <h1 class="text-2xl font-bold text-text-primary mb-2">
        {{ 'SET_PASSWORD.TITLE' | translate }}
      </h1>
      <p class="text-text-secondary text-sm">
        {{ 'SET_PASSWORD.SUBTITLE' | translate }}
      </p>
    </div>

    <!-- Error Message (Token/Server) -->
    <div *ngIf="errorMessage" class="mb-6 p-4 rounded-xl bg-error/10 border border-error/20 text-error text-center">
        {{ errorMessage }}
    </div>

    <!-- Form -->
    <form *ngIf="token && !errorMessage" [formGroup]="setPasswordForm" (ngSubmit)="onSubmit()" class="space-y-6">

      <div formGroupName="passwordGroup" class="space-y-4">
        <div class="space-y-1">
            <virteex-auth-input
              formControlName="password"
              type="password"
              [label]="'REGISTER.PASSWORD' | translate"
              [placeholder]="'REGISTER.PASSWORD_PLACEHOLDER' | translate"
              [required]="true"
              [hasIcon]="true"
              [errorMessage]="getErrorMessage('passwordGroup.password')">
              <svg icon xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect width="18" height="11" x="3" y="11" rx="2" ry="2"/><path d="M7 11V7a5 5 0 0 1 10 0v4"/></svg>
            </virteex-auth-input>

            <virteex-password-validator [password]="setPasswordForm.get('passwordGroup.password')?.value"></virteex-password-validator>
        </div>

        <virteex-auth-input
          formControlName="confirmPassword"
          type="password"
          [label]="'REGISTER.CONFIRM_PASSWORD' | translate"
          [placeholder]="'REGISTER.CONFIRM_PASSWORD_PLACEHOLDER' | translate"
          [required]="true"
          [hasIcon]="true"
          [errorMessage]="getErrorMessage('passwordGroup.confirmPassword')">
          <svg icon xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect width="18" height="11" x="3" y="11" rx="2" ry="2"/><path d="M7 11V7a5 5 0 0 1 10 0v4"/></svg>
        </virteex-auth-input>

        <div *ngIf="setPasswordForm.get('passwordGroup')?.errors?.['passwordMismatch'] && setPasswordForm.get('passwordGroup.confirmPassword')?.touched" class="text-xs text-error px-1">
            {{ 'REGISTER.ERRORS.PASSWORD_MISMATCH' | translate }}
        </div>
      </div>

      <virteex-auth-button
        type="submit"
        variant="primary"
        [loading]="isLoading"
        [disabled]="setPasswordForm.invalid">
        {{ (isLoading ? 'SET_PASSWORD.SAVING' : 'SET_PASSWORD.SUBMIT_BUTTON') | translate }}
      </virteex-auth-button>
    </form>
  </div>
</virteex-auth-layout>
